"use strict";(self.webpackChunkgatsby_starter_default=self.webpackChunkgatsby_starter_default||[]).push([[277],{7727:function(n,e,a){a.r(e),a.d(e,{default:function(){return c}});var s=a(8453),t=a(6540);function o(n){const e=Object.assign({p:"p",ul:"ul",li:"li",strong:"strong",h2:"h2",a:"a",span:"span",ol:"ol",h3:"h3",em:"em"},(0,s.RP)(),n.components);return t.createElement(t.Fragment,null,t.createElement(e.p,null,"n8n is an open-source automation platform that connects APIs, databases, and tools through visual workflows. You build workflows using nodesâ€”triggers, actions, and transformsâ€”and run them self-hosted or on n8n Cloud."),"\n",t.createElement(e.p,null,"Recently, I had to automate a product ops workflow: pull a product catalog, categorise items, surface close alternatives, and sync the results downstream. I used n8n as my automation engine and Neon as the database to handle deduping, versioning, and categorizing so the workflow could make smarter decisions over time."),"\n",t.createElement(e.p,null,"n8n provides official nodes for popular services like Slack, Google Sheets, and GitHub, but the real strength shows up in the community. Developers step in to cover the integrations the core team might never build. For example, Minhlucvan's Apify node brings web scraping workflows into n8n, Yatolstoy's Kommo node connects to a well-known CRM, and Mohsen Hadianfard's ApplyBoard node helps education agents sync student applications. These are polished, ready-to-use integrations built by third-party developers and published on the npm registry."),"\n",t.createElement(e.p,null,"Here's where things got interesting. At first, I used n8n's official Postgres node to connect to my Neon database, but it quickly felt limiting. Neon is a modern, serverless Postgres built for speed, scale, and branching, yet the generic Postgres node couldn't access features like branch switching. If I wanted to get the most out of Neon inside my workflows, I needed something else. That's when I decided to build a custom Neon node for n8n."),"\n",t.createElement(e.p,null,"The goal was to make something that works, and also build it in a way that followed n8n's conventions, handled database operations securely (avoiding SQL injection), and matched the quality bar of community nodes. The node needed to feel native to both n8n and Neon."),"\n",t.createElement(e.p,null,"The scope became clear:"),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"Execute custom queries"),"\n",t.createElement(e.li,null,"Standard CRUD (INSERT, SELECT, UPDATE, DELETE)"),"\n",t.createElement(e.li,null,"Support Neon's branch switching via the n8n UI"),"\n",t.createElement(e.li,null,"Follow n8n resources on building custom nodes"),"\n"),"\n",t.createElement(e.p,null,"With this scope in mind, I also had to decide which type of node architecture to use. n8n supports two approaches: ",t.createElement(e.strong,null,"programmatic nodes")," (trigger nodes) and ",t.createElement(e.strong,null,"declarative nodes")," (JSON-based syntax nodes). Given my goals, declarative was the obvious choice. It would keep the node maintainable and aligned with community standards."),"\n",t.createElement(e.h2,{id:"setting-up-my-custom-neon-node",style:{position:"relative"}},"Setting up My Custom Neon Node",t.createElement(e.a,{href:"#setting-up-my-custom-neon-node","aria-label":"setting up my custom neon node permalink",className:"gatsby-remark-autolink-header-anchor after"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",t.createElement(e.p,null,"Before setting up my environment, the first thing I had to do was get familiar with how n8n nodes are actually built."),"\n",t.createElement(e.p,null,"ðŸ‘‰ ",t.createElement(e.strong,null,"Before diving in")),"\n",t.createElement(e.p,null,"If you're thinking, maybe \"I'll try building a node myself\" here's what I had to get in place to get my environment running:"),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"Node.js + npm")," â†’ the bread and butter of building custom nodes"),"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"TypeScript")," â†’ because n8n speaks TS, not plain JS"),"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"Docker + Docker Compose")," â†’ easiest way to spin up n8n locally without headaches"),"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"Some JS/TS + Docker knowledge")," â†’ nothing advanced, but enough to not get stuck on the basics."),"\n"),"\n",t.createElement(e.p,null,"Once I had this stack ready, it was smooth sailing to clone n8n's starter template and strip it down for my own Neon node. ðŸš€"),"\n",t.createElement(e.p,null,"Nothing fancy yet, but at this point, only three essentials are really needed to get a custom node running:"),"\n",t.createElement(e.ol,null,"\n",t.createElement(e.li,null,"The ",t.createElement(e.strong,null,"node JSON file")),"\n",t.createElement(e.li,null,"The ",t.createElement(e.strong,null,"node TypeScript file")),"\n",t.createElement(e.li,null,"The ",t.createElement(e.strong,null,"credentials file")),"\n"),"\n",t.createElement(e.p,null,"That's the bare minimum foundation."),"\n",t.createElement(e.h3,{id:"structuring-the-node",style:{position:"relative"}},"Structuring the Node",t.createElement(e.a,{href:"#structuring-the-node","aria-label":"structuring the node permalink",className:"gatsby-remark-autolink-header-anchor after"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",t.createElement(e.p,null,"The n8n's official ",t.createElement(e.strong,null,"resource on building custom nodes")," already lays down the patterns people expect from database integrations, so sticking close to that gave my Neon node the same \"native\" feel. I also made one early call: go modular. It's tempting to cram everything into a single file, but Neon workflows can get hairy fast, and n8n's mental model is all about consistency. Every database node should feel familiar, so I leaned into that."),"\n",t.createElement(e.p,null,"In the n8n ecosystem, the recommended file structure is this:"),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"actions/")," â†’ sub-directories for each resource. Each contains:","\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"a resource description file (",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">&lt;resourceName>.resource.ts</code>'}})," or ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">index.ts</code>'}}),")"),"\n",t.createElement(e.li,null,"one file per operation (",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">&lt;operationName>.operation.ts</code>'}}),"), each exporting both the operation's description and its execute function"),"\n"),"\n"),"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"methods/")," â†’ optional, for dynamic parameter functions"),"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"transport/")," â†’ handles the actual communication layer (API calls, DB connections, etc.)"),"\n"),"\n",t.createElement(e.p,null,"With that mental model in mind, here's how my Neon node structure shaped up:"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">nodes/Neon/\nâ”œâ”€â”€ actions/operations/\nâ”‚   â”œâ”€â”€ executeQuery.operation.ts\nâ”‚   â”œâ”€â”€ insert.operation.ts\nâ”‚   â”œâ”€â”€ select.operation.ts\nâ”‚   â”œâ”€â”€ update.operation.ts\nâ”‚   â””â”€â”€ delete.operation.ts\nâ”œâ”€â”€ helpers/\nâ”‚   â”œâ”€â”€ utils.ts\nâ”‚   â””â”€â”€ interface.ts\nâ””â”€â”€ methods/\n    â”œâ”€â”€ credentialTest.ts\n    â”œâ”€â”€ listSearch.ts\n    â””â”€â”€ resourceMapping.ts</code></pre></div>'}}),"\n",t.createElement(e.p,null,"This separation of concerns made the whole thing more maintainable, and way easier for me to reason about."),"\n",t.createElement(e.p,null,"So basically, an n8n node is a single class in the main TypeScript file. That class acts as the entry point, the hub where credentials, operations, and helper methods all plug in. Mine looked something like this:"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>\n  IExecuteFunctions<span class="token punctuation">,</span>\n  INodeType<span class="token punctuation">,</span>\n  INodeTypeDescription<span class="token punctuation">,</span>\n<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'n8n-workflow\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> operations <span class="token keyword">from</span> <span class="token string">\'./actions/operations\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> listSearch<span class="token punctuation">,</span> credentialTest<span class="token punctuation">,</span> resourceMapping <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'./methods\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Neon</span> <span class="token keyword">implements</span> <span class="token class-name">INodeType</span> <span class="token punctuation">{</span>\n  description<span class="token operator">:</span> INodeTypeDescription <span class="token operator">=</span> <span class="token punctuation">{</span>\n    displayName<span class="token operator">:</span> <span class="token string">\'Neon\'</span><span class="token punctuation">,</span>\n    name<span class="token operator">:</span> <span class="token string">\'neon\'</span><span class="token punctuation">,</span>\n    icon<span class="token operator">:</span> <span class="token string">\'file:neon.svg\'</span><span class="token punctuation">,</span>\n    group<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'input\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    version<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n    subtitle<span class="token operator">:</span> <span class="token string">\'={{ $parameter["operation"] }}\'</span><span class="token punctuation">,</span>\n    description<span class="token operator">:</span> <span class="token string">\'Interact with Neon Database\'</span><span class="token punctuation">,</span>\n    defaults<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">\'Neon\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    inputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'main\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    outputs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'main\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    credentials<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n        name<span class="token operator">:</span> <span class="token string">\'neonApi\'</span><span class="token punctuation">,</span>\n        required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n        testedBy<span class="token operator">:</span> <span class="token string">\'neonCredentialTest\'</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    properties<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token comment">// Resource and operation definitions</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  methods <span class="token operator">=</span> <span class="token punctuation">{</span>\n    credentialTest<span class="token operator">:</span> <span class="token punctuation">{</span> neonCredentialTest<span class="token operator">:</span> credentialTest <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    listSearch<span class="token punctuation">,</span>\n    resourceMapping<span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">async</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> IExecuteFunctions<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// Route to appropriate operation</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",t.createElement(e.h3,{id:"mapping-modes-auto-vs-manual",style:{position:"relative"}},"Mapping Modes: Auto vs Manual",t.createElement(e.a,{href:"#mapping-modes-auto-vs-manual","aria-label":"mapping modes auto vs manual permalink",className:"gatsby-remark-autolink-header-anchor after"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",t.createElement(e.p,null,"When inserting data, I wanted to support two mapping modes:"),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"Auto-Map Input Data to Columns")," â†’ n8n maps the incoming JSON object directly to table columns. Perfect if the JSON keys from the previous node match the column names in the Neon database"),"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"Manual Map (Define Values Below)")," â†’ if keys don't match, the user will pick each column and set its value themselves. More tedious, but gives full control."),"\n"),"\n",t.createElement(e.p,null,"Here is an example of the INSERT operation config:"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> properties<span class="token operator">:</span> INodeProperties<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token comment">// Data to send for insert operations</span>\n  <span class="token punctuation">{</span>\n    displayName<span class="token operator">:</span> <span class="token string">\'Map Column Mode\'</span><span class="token punctuation">,</span>\n    name<span class="token operator">:</span> <span class="token string">\'mappingMode\'</span><span class="token punctuation">,</span>\n    type<span class="token operator">:</span> <span class="token string">\'options\'</span><span class="token punctuation">,</span>\n    options<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n        name<span class="token operator">:</span> <span class="token string">\'Auto-Map Input Data to Columns\'</span><span class="token punctuation">,</span>\n        value<span class="token operator">:</span> <span class="token string">\'autoMapInputData\'</span><span class="token punctuation">,</span>\n        description<span class="token operator">:</span> <span class="token string">\'Use when node input properties names exactly match the neon column names\'</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">{</span>\n        name<span class="token operator">:</span> <span class="token string">\'Map Each Column Manually\'</span><span class="token punctuation">,</span>\n        value<span class="token operator">:</span> <span class="token string">\'defineBelow\'</span><span class="token punctuation">,</span>\n        description<span class="token operator">:</span> <span class="token string">\'Set the value for each destination column manually\'</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">\'autoMapInputData\'</span><span class="token punctuation">,</span>\n    description<span class="token operator">:</span>\n      <span class="token string">\'Whether to map node input properties and the table data automatically or manually\'</span><span class="token punctuation">,</span>\n    displayOptions<span class="token operator">:</span> <span class="token punctuation">{</span>\n      show<span class="token operator">:</span> <span class="token punctuation">{</span>\n        resource<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'row\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n        operation<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'insert\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span>\n    displayName<span class="token operator">:</span> <span class="token string">\'Values to Send\'</span><span class="token punctuation">,</span>\n    name<span class="token operator">:</span> <span class="token string">\'valuesToSend\'</span><span class="token punctuation">,</span>\n    placeholder<span class="token operator">:</span> <span class="token string">\'Add Value\'</span><span class="token punctuation">,</span>\n    type<span class="token operator">:</span> <span class="token string">\'fixedCollection\'</span><span class="token punctuation">,</span>\n    typeOptions<span class="token operator">:</span> <span class="token punctuation">{</span>\n      multipleValueButtonText<span class="token operator">:</span> <span class="token string">\'Add Value\'</span><span class="token punctuation">,</span>\n      multipleValues<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    displayOptions<span class="token operator">:</span> <span class="token punctuation">{</span>\n      show<span class="token operator">:</span> <span class="token punctuation">{</span>\n        mappingMode<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'defineBelow\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    options<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n        displayName<span class="token operator">:</span> <span class="token string">\'Values\'</span><span class="token punctuation">,</span>\n        name<span class="token operator">:</span> <span class="token string">\'values\'</span><span class="token punctuation">,</span>\n        values<span class="token operator">:</span> <span class="token punctuation">[</span>\n          <span class="token punctuation">{</span>\n            displayName<span class="token operator">:</span> <span class="token string">\'Column\'</span><span class="token punctuation">,</span>\n            name<span class="token operator">:</span> <span class="token string">\'column\'</span><span class="token punctuation">,</span>\n            type<span class="token operator">:</span> <span class="token string">\'options\'</span><span class="token punctuation">,</span>\n            description<span class="token operator">:</span>\n              <span class="token string">\'Choose from the list, or specify an ID using an expression\'</span><span class="token punctuation">,</span>\n            typeOptions<span class="token operator">:</span> <span class="token punctuation">{</span>\n              loadOptionsMethod<span class="token operator">:</span> <span class="token string">\'getTableColumns\'</span><span class="token punctuation">,</span>\n              loadOptionsDependsOn<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'schema\'</span><span class="token punctuation">,</span> <span class="token string">\'table\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n          <span class="token punctuation">}</span><span class="token punctuation">,</span>\n          <span class="token punctuation">{</span>\n            displayName<span class="token operator">:</span> <span class="token string">\'Value\'</span><span class="token punctuation">,</span>\n            name<span class="token operator">:</span> <span class="token string">\'value\'</span><span class="token punctuation">,</span>\n            type<span class="token operator">:</span> <span class="token string">\'string\'</span><span class="token punctuation">,</span>\n            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">\'\'</span><span class="token punctuation">,</span>\n          <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  optionsCollection\n<span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> displayOptions <span class="token operator">=</span> <span class="token punctuation">{</span>\n  show<span class="token operator">:</span> <span class="token punctuation">{</span>\n    resource<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'row\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    operation<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'insert\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  hide<span class="token operator">:</span> <span class="token punctuation">{</span>\n    table<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"If the user selects manual mode, they see a ",t.createElement(e.strong,null,'"Values to Send"')," field where they can pick columns and provide values one by one. Behind the scenes, I had to normalise data from both modes into the same object structure before building the SQL query. Otherwise, I had to deal with unstable data formats."),"\n",t.createElement(e.p,null,"The catch? Not every input object matched the actual table schema. That led to confusing errors where inserts would silently fail. So before building the query, I pulled the schema directly from the database and cross-checked it with the input object. If any mismatch is found, I stop execution early."),"\n",t.createElement(e.h3,{id:"execute-operation-the-pain-hole",style:{position:"relative"}},"Execute Operation: The Pain Hole",t.createElement(e.a,{href:"#execute-operation-the-pain-hole","aria-label":"execute operation the pain hole permalink",className:"gatsby-remark-autolink-header-anchor after"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",t.createElement(e.p,null,"The INSERT operation was straightforward; EXECUTE was the tricky one. On the surface, the interface need is simple: a SQL editor for the raw query, plus a field for query parameters. A user could type something like:"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> id <span class="token operator">=</span> {{ $json<span class="token punctuation">.</span>userId }}</code></pre></div>'}}),"\n",t.createElement(e.p,null,"Looks fine, but here's the catchâ€”",t.createElement(e.strong,null,"n8n expressions (",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">{{ $json.userId }}</code>'}}),") aren't plain strings"),". They're dynamic placeholders. I passed them straight into my query, and Neon kept throwing errors."),"\n",t.createElement(e.p,null,"The fix was small but critical. I looped through the query, found all expressions, and resolved them before execution:"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> resolvable <span class="token keyword">of</span> <span class="token function">getExpressions</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>\n    resolvable<span class="token punctuation">,</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">evaluateExpression</span><span class="token punctuation">(</span>resolvable<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"Worked!!! As expected, I just had to play nicely with the queries."),"\n",t.createElement(e.h3,{id:"select-operation-condition-and-sorting",style:{position:"relative"}},"SELECT Operation: Condition and Sorting",t.createElement(e.a,{href:"#select-operation-condition-and-sorting","aria-label":"select operation condition and sorting permalink",className:"gatsby-remark-autolink-header-anchor after"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",t.createElement(e.p,null,"The SELECT operation felt trickier, but needed more thinking around it. The goal was to let users fetch rows with ",t.createElement(e.strong,null,"filters, conditions, and sort results"),"."),"\n",t.createElement(e.p,null,"So the interface need was clear:"),"\n",t.createElement(e.ol,null,"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"Select Rows")," â†’ A fixed collection where users pick a column, an operator (",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">=</code>'}}),", ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">></code>'}}),", ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">&lt;</code>'}}),", etc.), and a value. Example: ",t.createElement(e.em,null,"Column = age, Operator = >, Value = 18.")),"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"Combine Conditions")," â†’ A simple dropdown: ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">AND</code>'}})," or ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">OR</code>'}}),". This lets users build compound filters."),"\n",t.createElement(e.li,null,t.createElement(e.strong,null,"Sort")," â†’ A collection field where users choose a column and direction (",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">ASC</code>'}})," or ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">DESC</code>'}}),")."),"\n"),"\n",t.createElement(e.p,null,"Behind the scenes, I build a WHERE clause with these input values before proceeding to add it to the final query to be executed. For example:"),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"User config â†’ ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:"<code class=\"language-text\">{ column: 'age', operator: '>', value: 18 }</code>"}})),"\n",t.createElement(e.li,null,"Values â†’ ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:"<code class=\"language-text\">['age', 18]</code>"}})),"\n"),"\n",t.createElement(e.p,null,"Here's the built WHERE clause:"),"\n",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">WHERE</span> $<span class="token number">0</span>:name <span class="token operator">></span> $<span class="token number">1</span> <span class="token operator">AND</span> $<span class="token number">2</span>:name <span class="token operator">=</span> $<span class="token number">3</span></code></pre></div>'}}),"\n",t.createElement(e.p,null,"This pattern made SELECT operations safe. Users could stack conditions, combine them, and sort results without writing queries themselves."),"\n",t.createElement(e.h3,{id:"update-and-delete-operations",style:{position:"relative"}},"UPDATE and DELETE Operations",t.createElement(e.a,{href:"#update-and-delete-operations","aria-label":"update and delete operations permalink",className:"gatsby-remark-autolink-header-anchor after"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",t.createElement(e.p,null,"Once INSERT and SELECT were working, ",t.createElement(e.strong,null,"UPDATE")," and ",t.createElement(e.strong,null,"DELETE")," felt much easier. The patterns were already in place:"),"\n",t.createElement(e.ul,null,"\n",t.createElement(e.li,null,"Users will specify conditions the same way as SELECT."),"\n",t.createElement(e.li,null,"For UPDATE, they will choose which columns to modify and what the new values should be."),"\n",t.createElement(e.li,null,"For DELETE, they will choose to drop the whole table, truncate all the table data, or just delete rows that match the filter conditions."),"\n"),"\n",t.createElement(e.p,null,"By this point, the heavy lifting was done. Most of the work was making sure inputs were validated against the Neon schema and queries were parameterised for safety."),"\n",t.createElement(e.h2,{id:"challenges-and-moving-forward",style:{position:"relative"}},"Challenges and Moving Forward",t.createElement(e.a,{href:"#challenges-and-moving-forward","aria-label":"challenges and moving forward permalink",className:"gatsby-remark-autolink-header-anchor after"},t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}}))),"\n",t.createElement(e.p,null,"Looking back, one of the earliest decisions that saved me countless headaches was sticking with ",t.createElement(e.strong,null,"parameterised queries"),". Raw SQL feels more straightforward, especially when you're building complex conditions, but parameterisation gave me two wins at once: protection against injection and a consistent way to construct queries programmatically. ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">pg-promise</code>'}})," made this possible, to use syntax like ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">$1:name</code>'}})," or ",t.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">$2:name</code>'}}),", with this everything became smoother."),"\n",t.createElement(e.p,null,"Another key choice for me was leaning on ",t.createElement(e.strong,null,"n8n's conventions"),". Their documentation and official node patterns became my guardrails. Any time I drifted too far from those patterns, things broke. In n8n, conventions aren't optional."),"\n",t.createElement(e.p,null,"The irony? I spent more time researching, planning, and translating Neon requirements into n8n's mental model than actually writing code. The hardest part of building a custom node isn't SQL or TypeScript, it's learning how to translate the platform's needs into something that fits seamlessly into n8n's conventions."),"\n",t.createElement(e.p,null,"The fact that almost any custom node you can imagine is buildable in just a few weeks is wild â€” the custom node came together in such a short time, and it blew my mind."),"\n",t.createElement(e.p,null,"The code lives on GitHub. Fork it, run it, break it, fix it. ðŸš€"))}var p=function(n){void 0===n&&(n={});const{wrapper:e}=Object.assign({},(0,s.RP)(),n.components);return e?t.createElement(e,n,t.createElement(o,n)):o(n)};const l=n=>{const{data:e,children:a}=n;return t.createElement("div",null,"Post")};function c(n){return t.createElement(l,n,t.createElement(p,n))}},8453:function(n,e,a){a.d(e,{RP:function(){return o}});var s=a(6540);const t=s.createContext({});function o(n){const e=s.useContext(t);return s.useMemo(()=>"function"==typeof n?n(e):{...e,...n},[e,n])}}}]);
//# sourceMappingURL=component---src-templates-post-tsx-content-file-path-src-posts-2025-n-8-n-node-index-mdx-e1865c3bc8e6924f19fd.js.map